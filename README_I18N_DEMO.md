# 多语言演示页面使用说明

## 功能说明

已创建一个完整的多语言演示页面，展示以下功能：

1. **自动语言检测**：根据浏览器语言自动检测并显示对应语言
2. **手动语言切换**：点击语言按钮切换界面语言
3. **语言偏好持久化**：登录后切换语言会保存到数据库
4. **API 多语言响应**：测试不同语言下的 API 响应

## 访问方式

1. **启动服务器**：
   ```bash
   python -m uvicorn app.main:app --host 127.0.0.1 --port 8000 --reload
   ```

2. **访问演示页面**：
   - 浏览器打开：`http://127.0.0.1:8000/demo`
   - 或直接访问：`http://127.0.0.1:8000/static/i18n_demo.html`

## 功能演示

### 1. 语言切换（无需登录）
- 点击页面上的语言按钮（如"简体中文"、"English"等）
- 页面文本会立即切换为对应语言
- 当前语言会显示在"当前语言"区域

### 2. 语言偏好持久化（需要登录）
- 在登录区域输入用户名和密码登录
- 登录成功后，切换语言会：
  - 立即更新界面显示
  - **保存到数据库**（`users.language` 字段）
  - 下次登录时自动使用保存的语言

### 3. API 多语言响应测试
- 点击"测试健康检查"按钮，查看不同语言下的 API 响应
- 点击"测试根端点"按钮，查看欢迎消息的多语言版本
- API 响应会根据当前选择的语言返回对应的文本

## 测试步骤

1. **测试未登录状态的语言切换**：
   - 打开页面，点击不同语言按钮
   - 观察页面文本变化
   - 刷新页面，语言会恢复为浏览器默认语言

2. **测试登录后的语言持久化**：
   - 先注册一个测试账号（使用 `/api/v1/auth/register` 或 Swagger UI）
   - 登录账号
   - 切换语言（例如切换到英文）
   - 刷新页面或重新打开，语言应该保持为英文
   - 登出后重新登录，语言应该仍然是英文

3. **测试 API 多语言响应**：
   - 切换不同语言
   - 点击"测试健康检查"和"测试根端点"
   - 观察 API 响应中的文本是否对应当前语言

## 技术实现

- **前端**：纯 HTML + JavaScript（无框架依赖）
- **后端**：FastAPI + i18n 模块
- **持久化**：PostgreSQL 数据库（`users.language` 字段）
- **语言检测**：`Accept-Language` 请求头 + 用户数据库设置

## 注意事项

- 确保数据库已初始化并运行迁移
- 确保服务器已启动并可以访问
- 如果遇到 CORS 错误，检查 `CORS_ORIGINS` 配置
- 演示页面使用 localStorage 保存登录 token
